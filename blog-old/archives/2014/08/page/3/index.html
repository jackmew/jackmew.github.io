<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Page 3 | Archives: 2014/8 | Jackmew blog</title>
  <meta name="author" content="jackmew">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Jackmew blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Jackmew blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Jackmew blog</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
<h2 class="archive-title">2014/8</h2>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-08-01T01:17:44.000Z"><a href="/2014/08/01/20140801/">Aug 1 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/08/01/20140801/">2014/08/01</a></h1>
  

    </header>
    <div class="entry">
      
        <h1 id="Spring-ex08-security">Spring-ex08-security</h1>
<p>基本的登入帳號密碼驗證 之前就看過類似做法 但看了幾遍後 還是無法理解怎麼來的 怎麼會這樣子寫 文件在哪查？</p>
<p>只好怒研究作者提供的連結:</p>
<p>Rob Spring-security-3.2 <a href="http://spring.io/blog/2014/01/21/webinar-replay-spring-security-3-2" target="_blank">presentation </a> &amp; <a href="https://github.com/rwinch/gs-spring-security-3.2" target="_blank">github repository</a></p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/security/1.png" alt="image"></p>
<p>Spring.io 是 一個platform , 提供各式各式各樣服務的整合</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/security/2.png" alt="image"></p>
<p>inMemoryAuthentication =&gt; jdbcAuthenticatoin</p>
<h1 id="CSRF(Cross-site_request_forgery)_Protection">CSRF(Cross-site request forgery) Protection</h1>
<p>=&gt; one-click attack or session riding</p>
<p><a href="http://www.dotblogs.com.tw/joysdw12/archive/2013/09/16/asp-net-cross-site-request-forgery.aspx" target="_blank">寫得很詳細</a></p>
<h1 id="XSS(Cross-site_Scripting)">XSS(Cross-site Scripting)</h1>
<p><a href="http://jax-work-archive.blogspot.tw/2010/05/xss.html" target="_blank">link</a></p>
<h1 id="gs-spring-security-3-2">gs-spring-security-3.2</h1>
<p><a href="https://github.com/rwinch/gs-spring-security-3.2" target="_blank">link</a></p>
<p>已經加上Security了 , 把功能很簡單的程式寫得很複雜…</p>
<h1 id="等等？！_Spring_Security_都有這麼精緻的教學了_那Spring_annotation呢?">等等？！ Spring Security 都有這麼精緻的教學了 那Spring annotation呢?</h1>
<p>結果還真的查詢spring annotation tutorials 就有了…怎麼之前都沒想到 , 越看越覺得annotation的細節不理解 然後security又用一堆annotation… 要看的東西又變多了！</p>
<p><a href="http://simplespringtutorial.com/index.html" target="_blank">spring tutorial</a></p>
<h1 id="spring_tutorial">spring tutorial</h1>
<p><a href="http://simplespringtutorial.com/" target="_blank">link</a></p>
<h3 id="spring_dependency_injection">spring dependency injection</h3>
<p>設定Bean</p>
<ol>
<li>XML files 2. Properties </li>
</ol>
<p>然後Spring幫你inject你要的Bean</p>
<p>普通的java程式 , 比較像domain object , 接著你希望可以用這些object</p>
<p> <img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/1.png" alt="image"></p>
<p>將這些object 設成bean</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/2.png" alt="image"></p>
<p>接著讓Spring 使用這些bean</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/3.png" alt="image"></p>
<p>ClassPathXmlApplicationContext 設定路徑去抓bean的設定xxx.xml </p>
<h3 id="spring_resource_injection">spring resource injection</h3>
<p>我們常需要去讀某個在System or network 上的file,ex:取得某些設定的參數,i18n , 因此Spring提供了<code>Resource</code> 這個interface</p>
<h5 id="Read_a_file_from_…">Read a file from …</h5>
<ol>
<li><p>current working directory =&gt; <code>FileSystemResource</code></p>
</li>
<li><p>access using the url protocal =&gt; <code>UrlReource</code></p>
</li>
<li><p>on your classpath =&gt; <code>ClassPathResource</code></p>
</li>
</ol>
<h5 id="Injecting_Resources">Injecting Resources</h5>
<ol>
<li><p>Resource injection =&gt; loading <code>static</code> resources</p>
</li>
<li><p>Using ResourceLoader =&gt; loading <code>dynamic</code> resources ex:based on some business logic</p>
</li>
</ol>
<h3 id="spring_annotation">spring annotation</h3>
<p><a href="http://simplespringtutorial.com/annotations.html" target="_blank">link</a></p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/4.png" alt="image"></p>
<p>用.xml來設定bean</p>
<p>要注意的是<code>&lt;context:annotation-config /&gt;</code> 要加上這一行才能被@Autowired or @Resource 抓到</p>
<p>內容定義了三個bean</p>
<p>兩個是同一個Foo class 但不同id , 其中一個還定義了qualifier</p>
<p>一個是Bar class</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/5.png" alt="image"></p>
<p><code>@PostConstruct</code>  — 在contruct 之後—&gt; 表示這個function會在bean建立好之後直接執行</p>
<p><code>@PreDestroy</code> —&gt; 表示這個function會在bean destroy前 執行</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/6.png" alt="image"></p>
<p><code>@Autowired</code> 會去對應<code>型別 type</code>去抓bean , 根據Foo 去抓型別為Foo這個bean , 這是在.xml設定了兩個型別為Foo的bean , 這時候會出現<code>有兩個type 是Foo的bean</code> 的錯誤訊息 , 因此再加上<code>@Qualifer</code>  qualifer tag 的value</p>
<p><code>Resource</code> 去對應bean tag的id</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/7.png" alt="image"></p>
<p>執行成功 </p>
<p>問題是我不想要用.xml設定bean啊 , 想要用 <code>@Bean</code> 設定 要怎麼做?</p>
<h1 id="@Configuration_&amp;_@Bean_Annotations">@Configuration &amp; @Bean Annotations</h1>
<p><a href="http://www.tutorialspoint.com/spring/spring_java_based_configuration.htm" target="_blank">link</a></p>
<p>Annotating a class with the @Configuration indicates that the class can be used by the <code>Spring IoC container</code> as a source of bean definitions. </p>
<p>什麼事Spring Ioc Container ? 又出現看不懂的東西…</p>
<h1 id="spring_IoC(Inverse_of_Control)">spring IoC(Inverse of Control)</h1>
<p><a href="http://www.tutorialspoint.com/spring/spring_java_based_configuration.htm" target="_blank">簡單明瞭的解釋</a></p>
<ol>
<li>origin</li>
</ol>
<p>main —&gt; 抓參數 建立connection —&gt; 操作資料庫</p>
<p>所以說當我們要對資料庫操作時 都一定要執行一堆的程式 然後建立connection ?</p>
<p>那這樣這個程式 不就不能分開執行 也就是說藕合度很高!</p>
<ol>
<li>spring IoC</li>
</ol>
<p>所有的class都會登記在spring中  , 所以當要用的時候只要跟spring要就行了</p>
<p>main —&gt; annotation取得 connection —&gt; 操作資料庫</p>
<p>所以說可以拆得更散 當要某些東西時 跟spring要就好了(當然在這之間他就先執行完了 放在spring中等待人來使用) , 降低了藕合度</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/8.png" alt="image"></p>
<h1 id="回到@Configuration_&amp;_@Bean_Annotations">回到@Configuration &amp; @Bean Annotations</h1>
<p>我要把原本用.xml設定bean得例子 改成 java config </p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/9.png" alt="image"></p>
<p>.xml -&gt; Config.java</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/10.png" alt="image"></p>
<p>取得Configuration</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/11.png" alt="image"></p>
<p>console 表示 似乎有抓到bean的設定 但是@Configuration 需要CGLIB.jar , ASM.jar</p>
<p>跟另一邊的教學 說的是一樣的事情</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/12.png" alt="image"></p>
<p><a href="http://www.java2s.com/Code/Jar/a/Downloadasm31jar.htm" target="_blank">download ASM.jar</a></p>
<p><a href="http://www.java2s.com/Code/Jar/c/Downloadcglib22jar.htm" target="_blank">download cglib.jar</a></p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/13.png" alt="image"></p>
<p>出現的錯誤訊息 表示他不知道怎麼抓@Qualifier 定義個bean Foo</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/14.png" alt="image"></p>
<p>我先把Config bean Bar 註解掉 就成功了!!!</p>
<p>接下來<a href="http://stackoverflow.com/questions/9182805/spring-attaching-qualifer-to-java-configured-beans" target="_blank">解決@Qualifier的問題</a></p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/15.png" alt="image"></p>
<p>之前的.xml 被Config.java取代 , 而Qualifier tag 改成@Qualifier(“secondaryFoo”) 就可以了</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/16.png" alt="image"></p>
<p><code>Foo foo = ctx.getBean(&quot;foo&quot;, Foo.class);</code> 表示Bean type:Foo , id:foo 的這個Bean</p>
<p>console出現的Null表示 Bar autowired的兩個foo 都有instantiate ,但其中之一 我沒有asign值給name 所以顯示null</p>
<h1 id="Springmvc_Configuration">Springmvc Configuration</h1>
<p>完成以上範例後 就知道 為什麼在Springmvc 或 SpringBoot 裡面 有一堆@Configuration class 一堆</p>
<p>@Bean , @Controller , @Service , @Repository ,而不知道他們是什麼時候去執行的 , 所以說這算是某種標記 , 當有這些標記的 就會被register 到 Spring IoC container 中 等待執行 , 當需要使用的時候 才被@Autowired等方式 Inject到你需要的地方</p>
<h1 id="@import">@import</h1>
<p>將config 分成兩個 ConfigF (config foo) , ConfigB (config bar)</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/17.png" alt="image"></p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/18.png" alt="image"></p>
<p>因為Bar 需要用到 Foo 所以在ConfigB中import ConfigF</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/19.png" alt="image"></p>
<p>當抓到ConfigB.class 同時會 抓到ConfigF 因為已經import到ConfigB了</p>
<h1 id="Spring_Internationalization">Spring Internationalization</h1>
<p><a href="http://simplespringtutorial.com/i18n.html" target="_blank">i18n</a></p>
<p>Spring 中 處理多國語言的方法 : <code>ResourceBundleMessageSource</code></p>
<p>範例中用.xml設定bean處理</p>
<p>我改為java config</p>
<p>在這邊只列出跟原本寫法不同的地方</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/20.png" alt="image"></p>
<p>要注意的是<code>source.setBasename(&quot;i18n.javaConfig/messages&quot;);</code></p>
<p>你要給他對的路徑去抓message</p>
<p><img src="https://dl.dropboxusercontent.com/u/47510080/markdown/spring/annotation/21.png" alt="image"></p>
<p><code>ApplicationContext ctx = 
                  new AnnotationConfigApplicationContext(MessageConfig.class);</code></p>
<p>抓configuration</p>
<p>成功了!  原來如此 <code>ResourceBundleMessageResource</code> 就只是負責抓message的事情</p>
<h1 id="Spring_jdbc">Spring jdbc</h1>
<p><a href="http://simplespringtutorial.com/springjdbc.html" target="_blank">Spring jdbc</a></p>
<p><a href="http://jackmew.github.io/2014/07/22/20140722/">mysql ddl(Database Definition Language)</a></p>
<p>突然有一些問題產生:</p>
<ol>
<li><p>Autowired 沒辦法在main function中使用 ??? <a href="http://stackoverflow.com/questions/3659720/using-spring-3-autowire-in-a-standalone-java-application" target="_blank">解決方式</a></p>
</li>
<li><p>jdbcTemplate vs hibernate.sessionFactory ???</p>
</li>
<li><p>jdbcTemplate vs hibernate.sessionFactory vs CrudRepository ???</p>
</li>
<li><p>JPA vs Hibernate ???</p>
</li>
<li><p>@Controller @Service @Repository @Component 不用像@Bean 一樣設在@Configuration中 ??? 而且不用@Autowired or ApplicationContext去抓 就可以使用 ???</p>
</li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  

  <nav id="pagination">
  
    <a href="/archives/2014/08/page/2/" class="alignleft prev">Prev</a>
  
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:jackmew.github.io">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/blog/">blog</a><small>177</small></li>
  
    <li><a href="/categories/developent/">developent</a><small>2</small></li>
  
    <li><a href="/categories/leandev/">leandev</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/C/">C</a><small>1</small></li>
  
    <li><a href="/tags/CSS/">CSS</a><small>2</small></li>
  
    <li><a href="/tags/HTML/">HTML</a><small>1</small></li>
  
    <li><a href="/tags/JQuery/">JQuery</a><small>2</small></li>
  
    <li><a href="/tags/JQuery Validate/">JQuery Validate</a><small>1</small></li>
  
    <li><a href="/tags/Java/">Java</a><small>1</small></li>
  
    <li><a href="/tags/Jquery mobile/">Jquery mobile</a><small>1</small></li>
  
    <li><a href="/tags/MVC/">MVC</a><small>1</small></li>
  
    <li><a href="/tags/Mac/">Mac</a><small>1</small></li>
  
    <li><a href="/tags/REST/">REST</a><small>1</small></li>
  
    <li><a href="/tags/ajax/">ajax</a><small>1</small></li>
  
    <li><a href="/tags/android/">android</a><small>1</small></li>
  
    <li><a href="/tags/apache/">apache</a><small>1</small></li>
  
    <li><a href="/tags/blog/">blog</a><small>1</small></li>
  
    <li><a href="/tags/bower/">bower</a><small>1</small></li>
  
    <li><a href="/tags/callback/">callback</a><small>2</small></li>
  
    <li><a href="/tags/canvas/">canvas</a><small>2</small></li>
  
    <li><a href="/tags/command/">command</a><small>1</small></li>
  
    <li><a href="/tags/compass/">compass</a><small>1</small></li>
  
    <li><a href="/tags/cordova/">cordova</a><small>3</small></li>
  
    <li><a href="/tags/css/">css</a><small>7</small></li>
  
    <li><a href="/tags/development/">development</a><small>4</small></li>
  
    <li><a href="/tags/dropbox/">dropbox</a><small>2</small></li>
  
    <li><a href="/tags/eclipse/">eclipse</a><small>1</small></li>
  
    <li><a href="/tags/exception handle/">exception handle</a><small>1</small></li>
  
    <li><a href="/tags/express/">express</a><small>8</small></li>
  
    <li><a href="/tags/git/">git</a><small>3</small></li>
  
    <li><a href="/tags/gradle/">gradle</a><small>2</small></li>
  
    <li><a href="/tags/groovy/">groovy</a><small>1</small></li>
  
    <li><a href="/tags/gwt/">gwt</a><small>5</small></li>
  
    <li><a href="/tags/heroku/">heroku</a><small>4</small></li>
  
    <li><a href="/tags/hexo/">hexo</a><small>1</small></li>
  
    <li><a href="/tags/hibernate/">hibernate</a><small>1</small></li>
  
    <li><a href="/tags/host/">host</a><small>1</small></li>
  
    <li><a href="/tags/hosting/">hosting</a><small>1</small></li>
  
    <li><a href="/tags/java/">java</a><small>4</small></li>
  
    <li><a href="/tags/javasciprt/">javasciprt</a><small>2</small></li>
  
    <li><a href="/tags/javascript/">javascript</a><small>7</small></li>
  
    <li><a href="/tags/jquery/">jquery</a><small>1</small></li>
  
    <li><a href="/tags/jquery mobile/">jquery mobile</a><small>4</small></li>
  
    <li><a href="/tags/jquery plugin/">jquery plugin</a><small>1</small></li>
  
    <li><a href="/tags/json/">json</a><small>1</small></li>
  
    <li><a href="/tags/jsonp/">jsonp</a><small>2</small></li>
  
    <li><a href="/tags/kinecticjs/">kinecticjs</a><small>1</small></li>
  
    <li><a href="/tags/kineticjs/">kineticjs</a><small>1</small></li>
  
    <li><a href="/tags/log4j/">log4j</a><small>1</small></li>
  
    <li><a href="/tags/mac/">mac</a><small>6</small></li>
  
    <li><a href="/tags/maven/">maven</a><small>5</small></li>
  
    <li><a href="/tags/mobile/">mobile</a><small>1</small></li>
  
    <li><a href="/tags/mongo/">mongo</a><small>4</small></li>
  
    <li><a href="/tags/mou/">mou</a><small>1</small></li>
  
    <li><a href="/tags/mysql/">mysql</a><small>1</small></li>
  
    <li><a href="/tags/node/">node</a><small>10</small></li>
  
    <li><a href="/tags/nodejs/">nodejs</a><small>1</small></li>
  
    <li><a href="/tags/phoneGap/">phoneGap</a><small>1</small></li>
  
    <li><a href="/tags/phonegap/">phonegap</a><small>10</small></li>
  
    <li><a href="/tags/php/">php</a><small>1</small></li>
  
    <li><a href="/tags/plugin/">plugin</a><small>1</small></li>
  
    <li><a href="/tags/remote debug/">remote debug</a><small>1</small></li>
  
    <li><a href="/tags/ripple/">ripple</a><small>1</small></li>
  
    <li><a href="/tags/safari/">safari</a><small>1</small></li>
  
    <li><a href="/tags/sass/">sass</a><small>5</small></li>
  
    <li><a href="/tags/sencha/">sencha</a><small>13</small></li>
  
    <li><a href="/tags/shell/">shell</a><small>1</small></li>
  
    <li><a href="/tags/spring/">spring</a><small>2</small></li>
  
    <li><a href="/tags/spring boot/">spring boot</a><small>5</small></li>
  
    <li><a href="/tags/spring data jpa/">spring data jpa</a><small>5</small></li>
  
    <li><a href="/tags/spring data rest/">spring data rest</a><small>1</small></li>
  
    <li><a href="/tags/spring securitry/">spring securitry</a><small>1</small></li>
  
    <li><a href="/tags/springboot/">springboot</a><small>3</small></li>
  
    <li><a href="/tags/springmvc/">springmvc</a><small>5</small></li>
  
    <li><a href="/tags/springsecurity/">springsecurity</a><small>1</small></li>
  
    <li><a href="/tags/sublime/">sublime</a><small>2</small></li>
  
    <li><a href="/tags/tbs/">tbs</a><small>2</small></li>
  
    <li><a href="/tags/terminal/">terminal</a><small>1</small></li>
  
    <li><a href="/tags/thymeleaf/">thymeleaf</a><small>1</small></li>
  
    <li><a href="/tags/unit test/">unit test</a><small>1</small></li>
  
    <li><a href="/tags/vaadin/">vaadin</a><small>36</small></li>
  
    <li><a href="/tags/vaddin/">vaddin</a><small>1</small></li>
  
    <li><a href="/tags/validate/">validate</a><small>1</small></li>
  
    <li><a href="/tags/validation/">validation</a><small>1</small></li>
  
    <li><a href="/tags/vim/">vim</a><small>1</small></li>
  
    <li><a href="/tags/wbase/">wbase</a><small>4</small></li>
  
    <li><a href="/tags/weinre/">weinre</a><small>1</small></li>
  
    <li><a href="/tags/yahoo finance api/">yahoo finance api</a><small>1</small></li>
  
    <li><a href="/tags/yeoman/">yeoman</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 jackmew
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>